<!doctype html>

<html lang="ja">

<head>

<meta charset="utf-8" />

<meta name="viewport" content="width=device-width,initial-scale=1" />

<title>N4・強弱順位表</title>



<style>

:root{

 --bg:#fff8f3;

 --card:#fff;

 --accent:#cfa57a;

 --dark:#4b3828;

 --muted:#7a6654;

 --border:rgba(75,56,40,0.1);

 --panel:#fffaf5;

}



*{box-sizing:border-box;margin:0;padding:0}

body {

 margin:0;

 padding:0 18px 18px;

 background: var(--bg);

 color: var(--dark);

 font-family:"Noto Sans JP", system-ui, -apple-system, "Segoe UI", Roboto, Arial;

}



.wrap{width:100%;max-width:900px;margin:0 auto;}

header{

 background:linear-gradient(180deg,#fff,#fff7ee);

 padding:14px;

 border-radius:10px;

 border:1px solid var(--border);

 margin-top:18px;

}

h1{margin:0;font-size:18px;color:var(--dark);}

.lead{margin:6px 0 0;color:var(--muted);font-size:13px;}

.card{

 background:var(--card);

 border:1px solid var(--border);

 border-radius:12px;

 padding:14px;

 margin-top:14px;

 box-shadow:0 2px 6px rgba(90,60,30,0.03);

}

label.small{display:block;font-size:13px;color:var(--muted);margin-bottom:8px;}

textarea#input{

 width:100%;

 min-height:110px;

 padding:12px;

 border-radius:10px;

 border:1px solid var(--border);

 background:var(--panel);

 font-family:monospace;

 font-size:14px;

}

.controls{display:flex;gap:8px;margin-top:10px;justify-content:flex-end;}

button.btn{

 background:var(--accent);

 color:white;

 border:none;

 padding:8px 12px;

 border-radius:8px;

 cursor:pointer;

}

button.ghost{

 background:transparent;

 color:var(--dark);

 border:1px solid var(--border);

 padding:8px 12px;

 border-radius:8px;

 cursor:pointer;

}

.note{margin-top:8px;color:var(--muted);font-size:13px;}



.result-box{

 margin-top:14px;

 padding:16px;

 background:#fffaf5;

 border:1px solid #e6d6c2;

 border-radius:10px;

}

.result-title{

 font-weight:700;

 color:var(--dark);

 margin-bottom:12px;

 font-size:15px;

}

.rank-display{

 font-size:18px;

 font-weight:700;

 font-family:monospace;

 margin-bottom:16px;

 text-align:center;

 color:var(--dark);

}

.group-section{

 margin-bottom:10px;

 line-height:1.8;

 font-size:13px;

}

.group-label{

 font-weight:600;

 color:var(--dark);

}

</style>

</head>



<body>

<div class="wrap">

 <header>

  <h1>N4・強弱順位表</h1>

  <div class="lead">N4（4桁）。古→新の順で当選番号を貼り付けてください（スペース or 改行で区切り）。12回推奨。</div>

 </header>



 <div class="card">

  <label class="small">当選番号（古→新）</label>

  <textarea id="input" placeholder="例: 2477 7728 1540 0012"></textarea>



  <div class="controls">

   <button class="btn" id="analyze">解析する</button>

   <button class="ghost" id="clear">クリア</button>

  </div>



  <div class="note">※入力は古→新（最新が最後）。4桁でないトークンは無視されます。表示は0埋め（例: 0075）で揃えます。</div>



  <div id="result"></div>

 </div>

</div>



<script>

function getIXType(numStr){

 const digits = numStr.padStart(4,'0').split('').map(Number);

 const unique = new Set(digits).size;

 if(unique===1) return 'IIII';

 if(unique===2) return 'IIIX';

 if(unique===3) return 'IIXX';

 if(unique===4) return 'IXXX';

 return 'XXXX';

}



function computeRankFromSlice(sliceStrings){

 const digitStats=[Array(10).fill(0),Array(10).fill(0),Array(10).fill(0),Array(10).fill(0)];

 sliceStrings.forEach(s=>{

  const padded = s.padStart(4,'0');

  const arr = padded.split('').map(Number);

  arr.forEach((d,i)=>digitStats[i][d]++);

 });

 const total = Array(10).fill(0);

 for(let d=0; d<=9; d++) total[d] = digitStats[0][d]+digitStats[1][d]+digitStats[2][d]+digitStats[3][d];

 const rank = total.map((score,digit)=>({digit,score})).sort((a,b)=>{

  if(b.score !== a.score) return b.score - a.score;

  return a.digit - b.digit;

 }).map(o=>o.digit);

 

 const digitCount = Array(10).fill(0);

 sliceStrings.forEach(s=>{

  const padded = s.padStart(4,'0');

  const digits = padded.split('').map(Number);

  const uniqueDigits = [...new Set(digits)];

  uniqueDigits.forEach(d => digitCount[d]++);

 });

  

 const lastSeen = Array(10).fill(-1);

 sliceStrings.forEach((s, idx) => {

  const padded = s.padStart(4, '0');

  const digits = padded.split('').map(Number);

  const uniqueDigits = [...new Set(digits)];

  uniqueDigits.forEach(d => {

   lastSeen[d] = idx;

  });

 });



 const timeLag = Array(10).fill(0);

 const currentIndex = sliceStrings.length - 1;

 for(let d = 0; d <= 9; d++) {

  if(lastSeen[d] === -1) {

   timeLag[d] = currentIndex + 1;

  } else {

   timeLag[d] = currentIndex - lastSeen[d];

  }

 }



 return { rank, total, digitStats, digitCount, timeLag };

}



document.getElementById('analyze').addEventListener('click', ()=>{

 const raw=document.getElementById('input').value.trim();

 if(!raw){ alert('当選番号を入力してください（古→新）'); return; }

 const tokens=raw.split(/\s+/).map(s=>s.trim()).filter(Boolean);

 const nums=tokens.map(s=>{

  const m=s.match(/^\d{1,4}$/);

  if(!m) return null;

  const num = parseInt(s,10);

  if(num < 0 || num > 9999) return null;

  return String(num).padStart(4,'0');

 }).filter(x=>x!==null);

 if(nums.length===0){ alert('正しい当選番号を入力してください。'); return; }

  

 const res=computeRankFromSlice(nums);

 const rank=res.rank;

 const strong=rank.slice(0,3);

 const middle=rank.slice(3,6);

 const weak=rank.slice(6);

  

 const strongLabel = strong.map(d => `${d}(${res.digitCount[d]}回/${res.timeLag[d]}回前)`).join(', ');

 const middleLabel = middle.map(d => `${d}(${res.digitCount[d]}回/${res.timeLag[d]}回前)`).join(', ');

 const weakLabel = weak.map(d => `${d}(${res.digitCount[d]}回/${res.timeLag[d]}回前)`).join(', ');

  

 let resultHTML = `

  <div class="result-box">

   <div class="result-title">【最新の強弱順位】</div>

   <div class="rank-display">${rank.join(' ＞ ')}</div>

   <div class="group-section"><span class="group-label">強：</span>${strongLabel}</div>

   <div class="group-section"><span class="group-label">中：</span>${middleLabel}</div>

   <div class="group-section"><span class="group-label">弱：</span>${weakLabel}</div>

  </div>

 `;

  

 if(nums.length >= 2) {

  const prev1 = nums[nums.length - 1];

  const prev2 = nums[nums.length - 2];

   

  const iGroupSet = new Set();

  [prev1, prev2].forEach(numStr => {

   numStr.split('').forEach(d => iGroupSet.add(d));

  });

   

  const iGroup = Array.from(iGroupSet).sort();

  const xGroup = ['0','1','2','3','4','5','6','7','8','9'].filter(d => !iGroupSet.has(d));

   

  resultHTML += `

   <div class="result-box">

    <div class="result-title">【IXタイプ分析】</div>

    <div style="font-size:13px;line-height:1.8;color:var(--muted);">

     前回：${prev1} / 前々回：${prev2}<br>

     Iグループ：${iGroup.join(', ')}<br>

     Xグループ：${xGroup.join(', ')}

    </div>

   </div>

  `;

 }

  

 document.getElementById('result').innerHTML = resultHTML;

});



document.getElementById('clear').addEventListener('click', ()=>{

 document.getElementById('input').value='';

 document.getElementById('result').innerHTML='';

});

</script>

</body>

</html>
